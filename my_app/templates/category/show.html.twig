{% extends 'base.html.twig' %}

{% block title %}{{ category.name }}{% endblock %}

{% block body %}
<div class="product-page-container container px-4">
    <div class="row g-4 product-page-layout">
        <aside class="product-sidebar col-12 col-lg-3 col-xl-2">
            <div class="position-sticky top-nav-offset">
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-white border-0">
                        <h2 class="h6 mb-0 text-uppercase text-muted">Categories</h2>
                        <small class="text-muted">{{ category.name }}</small>
                    </div>
                    <div class="list-group list-group-flush" id="category-list">
                        <a
                            href="{{ path('app_home') }}"
                            class="list-group-item list-group-item-action"
                            id="all-products-link"
                            data-products-url="{{ path('app_all_products') }}"
                            data-category-name="Products"
                            data-category-description=""
                        >
                            All Products
                        </a>
                        {% for cat in categories %}
                            <a
                                href="{{ path('app_category_show', {slug: cat.slug}) }}"
                                class="list-group-item list-group-item-action category-link{% if cat.slug == category.slug %} active{% endif %}"
                                data-slug="{{ cat.slug }}"
                                data-products-url="{{ path('app_category_products', {slug: cat.slug}) }}"
                                data-category-name="{{ cat.name }}"
                                data-category-description="{{ cat.description|default('')|striptags|e('html_attr') }}"
                            >
                                {{ cat.name }}
                                <span class="badge bg-secondary-subtle text-secondary-emphasis rounded-pill ms-2">{{ categoryCounts[cat.slug]|default(0) }}</span>
                            </a>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </aside>

        <section class="col-12 col-lg-9 col-xl-10">
            <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-3 mb-4">
                <div>
                    <h2 class="h4 mb-1 text-dark" id="category-title">{{ category.name }}</h2>
                    <p class="text-muted mb-0{% if category.description is empty %} d-none{% endif %}" id="category-description">
                        {{ category.description }}
                    </p>
                </div>
            </div>
            <div id="product-list">
                {% include 'category/_products.html.twig' with {'products': products} %}
            </div>
        </section>
    </div>
</div>
{% endblock %}
